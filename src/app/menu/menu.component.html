<mat-toolbar>
    <!-- Desktop Navigation -->
    <ng-container *ngIf="!(isMobile$ | async)">
        <span class="nav-links">
            <a routerLink="" mat-button *ngIf="isAuthenticated$ | async">
                <mat-icon>inventory</mat-icon>
                <span class="nav-text">Products</span>
            </a>
            <a routerLink="links" mat-button *ngIf="isAuthenticated$ | async">
                <mat-icon>link</mat-icon> 
                <span class="nav-text">Links</span>
            </a>
        </span>
        
        <span class="spacer"></span>
        
        <div *ngIf="isAuthenticated$ | async; else loginButtons" class="user-section">
            <!-- User Menu -->
            <button mat-button [matMenuTriggerFor]="userMenu" class="user-button">
                @if (getProfilePictureUrl(user$ | async)) {
                    <img [src]="getProfilePictureUrl(user$ | async)" 
                         [alt]="getDisplayName(user$ | async)" 
                         class="profile-avatar">
                } @else {
                    <mat-icon>account_circle</mat-icon>
                }
                <span class="user-name-display">{{ getDisplayName(user$ | async) }}</span>
            </button>
            
            <mat-menu #userMenu="matMenu">
                <div class="user-info">
                    <span class="user-name">{{ (user$ | async)?.firstName || 'User' }}</span>
                    <span class="user-email">{{ (user$ | async)?.email }}</span>
                </div>
                <mat-divider></mat-divider>
                <button mat-menu-item routerLink="/profile">
                    <mat-icon>edit</mat-icon>
                    Edit Profile
                </button>
                <button mat-menu-item (click)="logout()">
                    <mat-icon>logout</mat-icon>
                    Logout
                </button>
            </mat-menu>
        </div>
        
        <ng-template #loginButtons>
            <div class="auth-buttons">
                <a routerLink="/login" mat-button>
                    <mat-icon>login</mat-icon>
                    <span class="auth-text">Login</span>
                </a>
                <a routerLink="/register" mat-button>
                    <mat-icon>person_add</mat-icon>
                    <span class="auth-text">Register</span>
                </a>
            </div>
        </ng-template>
    </ng-container>
    
    <!-- Mobile Navigation -->
    <ng-container *ngIf="isMobile$ | async">
        <span class="mobile-nav-links" *ngIf="isAuthenticated$ | async; else mobileLoginButtons">
            <a routerLink="" mat-button class="mobile-nav-button">
                <div class="mobile-nav-content">
                    <mat-icon>inventory</mat-icon>
                    <span class="mobile-nav-text">Products</span>
                </div>
            </a>
            <a routerLink="links" mat-button class="mobile-nav-button">
                <div class="mobile-nav-content">
                    <mat-icon>link</mat-icon> 
                    <span class="mobile-nav-text">Links</span>
                </div>
            </a>
            
            <!-- Mobile User Menu -->
            <button mat-button [matMenuTriggerFor]="mobileUserMenu" class="mobile-nav-button">
                <div class="mobile-nav-content">
                    @if (getProfilePictureUrl(user$ | async)) {
                        <img [src]="getProfilePictureUrl(user$ | async)" 
                             [alt]="getDisplayName(user$ | async)" 
                             class="mobile-profile-avatar">
                    } @else {
                        <mat-icon>account_circle</mat-icon>
                    }
                    <span class="mobile-nav-text">{{ getDisplayName(user$ | async) }}</span>
                </div>
            </button>
            
            <mat-menu #mobileUserMenu="matMenu">
                <div class="user-info">
                    <span class="user-name">{{ (user$ | async)?.firstName || 'User' }}</span>
                    <span class="user-email">{{ (user$ | async)?.email }}</span>
                </div>
                <mat-divider></mat-divider>
                <button mat-menu-item routerLink="/profile">
                    <mat-icon>edit</mat-icon>
                    Edit Profile
                </button>
                <button mat-menu-item (click)="logout()">
                    <mat-icon>logout</mat-icon>
                    Logout
                </button>
            </mat-menu>
        </span>
        
        <ng-template #mobileLoginButtons>
            <div class="mobile-auth-buttons">
                <a routerLink="/login" mat-button class="mobile-nav-button">
                    <div class="mobile-nav-content">
                        <mat-icon>login</mat-icon>
                        <span class="mobile-nav-text">Login</span>
                    </div>
                </a>
                <a routerLink="/register" mat-button class="mobile-nav-button">
                    <div class="mobile-nav-content">
                        <mat-icon>person_add</mat-icon>
                        <span class="mobile-nav-text">Register</span>
                    </div>
                </a>
            </div>
        </ng-template>
    </ng-container>
</mat-toolbar>
